# Go

2024年9月4日 叶茂林

#### 知识链接

[Go 程序员面试笔试宝典 | Go 程序员面试笔试宝典 (golang.design)](https://golang.design/go-questions/)

#### 基本语法

go声明的变量必须被使用，否则需要使用_来替代掉变量名，表明该变量不会被使用到

对于基本类型来讲，声明即初始化；对于引用类型，声明则初始化为nil

在 Golang 中只有同长度、同类型的数组才可视为“同一类型”，譬如 [4]int 和 [3]int 则会被视为不同的类型，这在参数传递的时候会造成编译错误

所有的基本类型都属于值类型，但是有几个类型比较特殊，表现出引用类型的特征，分别是 slice、map、channel、interface ，除赋值以外它们都可以当做引用类型来使用

go传入函数参数的是原对象的一个全新的 copy （有自己的内存地址）

#### 包的可见性

go包的可见性规则是通过标识符的首字母大小写来控制的，如果一个函数、变量或类型名以大写字母开头，则它是导出的（exported），可以被其他包访问，如果以小写字母开头，则它是未导出的（unexported），只能在定义它的包内访问

#### 协程

go没有用户级线程，只有轻量级的协程，go调度器可以将协程映射到少量的内核线程运行

协程通信：通道、互斥锁、等待组

go协程不会阻塞，需要等待执行完成

```go
package main
import "sync"
func main() {
    var wg sync.WaitGroup
    wg.Add(1) //增加等待计数
    go func() {
        defer wg.Done() //减少等待计数
    }()
    wg.Wait()
}
```

#### 切片

数组就是一片连续的内存， slice 实际上是一个结构体，包含三个字段：长度、容量、底层数组

```go
type slice struct {
	array unsafe.Pointer // 元素指针
	len   int // 长度 
	cap   int // 容量
}
```

底层数组是可以被多个 slice 同时指向的，因此对一个 slice 的元素进行操作是有可能影响到其他 slice 的

```go
func main() {
    a:=[]int{1,2,3}
    b:=[]int{4,5,6}
    a=b
    b[1]=0
    fmt.Println(a) // [4 0 6]
}
```

#### 异常处理

所有可能出现异常的方法或者代码直接把错误当作第二个响应值进行返回，程序中对返回值进行判断，非空则进行处理

defer的作用是延迟执行某段代码，多个defer一开始用的链表存储后来用栈存储，都是先进后出

recover 的作用是捕捉 panic 抛出的错误并进行处理，需要联合 defer 来使用

函数return的时候会先赋值返回值，调用defer，然后return
